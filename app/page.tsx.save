 Navbar } from "@/components/navbar"
import { Button } from "@/components/ui/button"
import { Input } from "@/components/ui/input"
import { prisma } from "@/lib/prisma"
import { ListingCard } from "@/components/listing-card"
import { Toaster } from "@/components/ui/toaster"

export default async function HomePage() {
  // Récupérer les listings publiés (limite 6 pour la page d'accueil)
  const featuredListings = await prisma.listing.findMany({
    where: { status: "PUBLISHED" },
    take: 6,
    orderBy: { createdAt: "desc" },
    include: {
      landlord: {
        include: {
          landlordProfile: true,
        },
      },
   
  })

  return (
    <>
      <Navbar />
      <main className="min-h-screen">
        {/* Hero Section */}
        <section className="bg-gradient-to-br from-primary/10 to-primary/5 py-20">
          <div className="container mx-auto px-4">
            <div className="max-w-3xl mx-auto text-center">
              <h1 className="text-5xl font-bold mb-6">
                Trouvez votre prochain logement à long terme
              </h1>
              <p className="text-xl text-muted-foreground mb-8">
                LeaseFlow simplifie le processus de location avec gestion complète
                des candidatures, contrats et paiements.
              </p>
              <div className="flex gap-4 justify-center">
                <Link href="/listings">
                  <Button size="lg">Rechercher un logement</Button>
                </Link>
              </div>
            </div>
          </div>
        </section>

        {/* Search Bar */}
        <section className="py-8 bg-white border-b">
          <div className="container mx-auto px-4">
            <form action="/listings" method="get" className="max-w-4xl mx-auto">
              <div className="flex gap-4">
                <Input
                  name="city"
                  placeholder="Ville..."
                  className="flex-1"
                />
                <Input
                  name="minPrice"
                  type="number"
                  placeholder="Prix min (€)"
                  className="w-32"
                />
                <Input
                  name="maxPrice"
                  type="number"
                  placeholder="Prix max (€)"
                  className="w-32"
                />
                <Button type="submit">Rechercher</Button>
              </div>
            </form>
          </div>
        </section>

        {/* Featured Listings */}
        <section className="py-16">
          <div className="container mx-auto px-4">
            <h2 className="text-3xl font-bold mb-8">Logements en vedette</h2>
            {featuredListings.length > 0 ? (
              <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                {featuredListings.map((listing) => (
                  <ListingCard key={listing.id} listing={listing} />
                ))}
              </div>
            ) : (
              <p className="text-muted-foreground">
                Aucun logement disponible pour le moment.
              </p>
            )}
            <div className="mt-8 text-center">
              <Link href="/listings">
                <Button variant="outline">Voir tous les logements</Button>
              </Link>
            </div>
          </div>
        </section>
      </main>
      <Toaster />
    </>
  )
}

